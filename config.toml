# macros
[macros.install__apt]
  prefix = ['sudo', 'apt-get', 'install', '-y']

[macros.install__dnf]
  prefix = ['sudo', 'dnf', '-y', 'install']

[macros.brew]
  prefix = ['brew', 'install', '-f']

[macros.goget]
  deps = ['golang']
  prefix = ['go', 'get']

[macros.clone]
  deps = ['git']
  prefix = ['git', 'clone']

# tasks
[tasks.git]
  rejects = [['which', 'git']]
  cmdspre = [['echo', 'Installing git']]
  cmds = [['@install', 'git']]
  cmdspost = [['echo', 'Installed git!']]

[tasks.n]

  envs = [['N_PREFIX', '${HOME}/.n']]
  rejects = [['test', '-d',  '${N_PREFIX}']]
  cmds = [['curl', '-L', 'https://git.io/n-install', '-o', '/tmp/n-install'], ['bash', '/tmp/n-install']]

[tasks.yarn]
  rejects = [['which', 'yarn']]
  cmdspre = [['curl', '-L', 'https://dl.yarnpkg.com/rpm/yarn.repo', '-o', '/tmp/yarn-install'], ['sudo', 'cp', '/tmp/yarn-install', '/etc/yum.repos.d/yarn.repo']]
  cmds = [['@install', 'yarn']]
  deps = ['n']

[tasks.golang]
  envs = [['GOPATH', '${HM_DEST}/projects/go']]
  rejects = [['which', 'go']]
  cmdspre = [['echo', 'Installing golang']]
  cmds = [['mkdir', '-p', '$GOPATH'], ['@install', 'golang']]
  cmdspost = [['echo', 'Installed golang!']]

# base tasks
[tasks.system_apps]
  envs = [['GOPATH', '${HM_DEST}/projects/go']]
  cmdspre = [['echo', 'Installing system_apps'], ['mkdir', '-p', '$GOPATH']]
  cmds = [['@install', 'zsh', 'git', 'curl', 'golang', 'pv', 'bat']]
  cmdspost = [['chsh', '-s', '/usr/bin/zsh'], ['echo', 'Installed system_apps!']]

[tasks.brew_apps]
  cmdspre = [['echo', 'Installing brew apps']]
  cmds = [['@brew', 'tmux', 'ripgrep', 'fzf']]
  cmdspost = [['echo', 'Installed brew apps!']]

[tasks.go_apps]
  cmdspre = [['echo', 'Installing go apps']]
  cmds = [['@goget', '-u', 'github.com/augustoroman/highlight']]

[tasks.base]
  deps = ['system_apps', 'brew_apps', 'go_apps', 'yarn']

[tasks.symlinks]
  cmdspre = [['echo', 'Symlinks will be created at', '${HM_DEST}']]
  cmdspost = [['echo', 'Symlinks created (or recreated)!']]
  links = [
    ['.agignore', 'rcfiles/agignore'],
    ['.aria2/aria2.conf', 'rcfiles/aria2.conf'],
    ['.colordiffrc', 'rcfiles/colordiffrc'],
    ['.config/alacritty/alacritty.yml', 'rcfiles/alacritty.yml'],
    ['.config/nvim/init.vim', 'rcfiles/neovim'],
    ['.gitconfig', 'rcfiles/gitconfig'],
    ['.gnupg/gpg.conf', 'rcfiles/gpg.conf'],
    ['.inputrc', 'rcfiles/inputrc'],
    ['.npmrc', 'rcfiles/npmrc'],
    ['.psqlrc', 'rcfiles/psqlrc'],
    ['.screenrc', 'rcfiles/screenrc'],
    ['.tmux.conf', 'rcfiles/tmux.conf'],
    ['.Xresources', 'rcfiles/Xresources'],
    ['.zsh', 'rcfiles/zsh'],
    ['.zshrc', 'rcfiles/zshrc']
  ]

[tasks.default]
  deps = ['base', 'symlinks']
